{% extends "trackerapp/base.html" %}


{% block content %}

<div class="row">
    <div class="col s12 m6">

        <canvas id="myChart" width="400" height="400"></canvas>
        
    </div>
    <div class="col s12 m6">

        {% for transaction in transactions %}
        <ul>
            <li>{{ transaction }}</li>
        </ul>
        {% endfor %}

        <a class="btn-floating btn-large waves-effect waves-light red" href="/add_expense"><i class="material-icons">remove</i></a>
        <a class="waves-effect teal accent-4 btn-large" href="/transactions">Balance {{ balance }}</a>
        <a class="btn-floating btn-large waves-effect waves-light red" href="/add_income"><i class="material-icons">add</i></a>
    </div>    
</div>
{% endblock %}

{% block scripts %}
<script>
    var endpoint = '{% url "api-data" %}'
    var defaultData = []
    var labels = []

    $.ajax({
        method: "GET",
        url: endpoint,
        success: function(context){
            labels = context.category_label
            defaultData = context.total_expense
            var ctx = document.getElementById('myChart');
            var myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    label: '$',
                    data: defaultData,                    
                }]
            }
            })
        }, 
        error: function(error_context){
            console.log("error")
            console.log(error_context)
        },
    })

</script>
{% endblock %}

